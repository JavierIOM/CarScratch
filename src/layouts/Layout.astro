---
interface Props {
  title?: string;
  description?: string;
  canonicalPath?: string;
  ogImage?: string;
  noIndex?: boolean;
}

const SITE_URL = 'https://carscratch.netlify.app';
const SITE_NAME = 'CarScratch';

const {
  title = 'CarScratch - UK & Isle of Man Vehicle Information',
  description = 'Free UK and Isle of Man vehicle lookup. Check MOT history, tax status, mileage, specifications, ULEZ compliance and more using any registration number.',
  canonicalPath = '',
  ogImage = '/og-image.png',
  noIndex = false
} = Astro.props;

const canonicalURL = `${SITE_URL}${canonicalPath}`;
const ogImageURL = ogImage.startsWith('http') ? ogImage : `${SITE_URL}${ogImage}`;

// JSON-LD structured data for the website
const websiteSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  name: SITE_NAME,
  url: SITE_URL,
  description: 'Free UK and Isle of Man vehicle information lookup service',
  potentialAction: {
    '@type': 'SearchAction',
    target: {
      '@type': 'EntryPoint',
      urlTemplate: `${SITE_URL}/lookup/{registration}`
    },
    'query-input': 'required name=registration'
  }
};

// JSON-LD for the organization
const organizationSchema = {
  '@context': 'https://schema.org',
  '@type': 'Organization',
  name: SITE_NAME,
  url: SITE_URL,
  logo: `${SITE_URL}/favicon.svg`,
  sameAs: [
    'https://github.com/JavierIOM/CarScratch'
  ]
};
---

<!doctype html>
<html lang="en-GB">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="keywords" content="UK vehicle check, car check, MOT history, tax status, DVLA lookup, vehicle registration, Isle of Man, Manx plates, ULEZ check, mileage history, vehicle specifications" />
    <meta name="author" content="Javier" />
    <meta name="robots" content={noIndex ? 'noindex, nofollow' : 'index, follow'} />
    <meta name="googlebot" content={noIndex ? 'noindex, nofollow' : 'index, follow'} />

    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImageURL} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content={SITE_NAME} />
    <meta property="og:locale" content="en_GB" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageURL} />

    <!-- Favicon and Icons -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Theme Color -->
    <meta name="theme-color" content="#0f172a" />
    <meta name="msapplication-TileColor" content="#0f172a" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet" />

    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />

    <!-- Structured Data -->
    <script is:inline type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
    <script is:inline type="application/ld+json" set:html={JSON.stringify(organizationSchema)} />
  </head>
  <body class="min-h-screen bg-slate-900 text-slate-100">
    <header class="border-b border-slate-800">
      <div class="max-w-5xl mx-auto px-4 py-4 flex items-center justify-between">
        <a href="/" class="flex items-center gap-2 hover:opacity-80 transition-opacity" aria-label="CarScratch Home">
          <svg class="w-8 h-8 text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M7 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
            <path d="M17 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
            <path d="M5 17h-2v-6l2 -5h9l4 5h1a2 2 0 0 1 2 2v4h-2m-4 0h-6m-6 -6h15m-6 0v-5" />
          </svg>
          <span class="text-lg font-semibold tracking-tight">CarScratch</span>
        </a>
        <nav class="text-sm text-slate-400" aria-label="Site tagline">
          <span>UK and Isle of Man Vehicle Lookup</span>
        </nav>
      </div>
    </header>

    <main id="main-content">
      <slot />
    </main>

    <footer class="border-t border-slate-800 mt-auto">
      <div class="max-w-5xl mx-auto px-4 py-6 text-center text-sm text-slate-500">
        <p>Data sourced from DVLA, MOT History Service, and Isle of Man Government. For informational purposes only.</p>
        <p class="mt-2">
          <a href="/suggestions" class="text-amber-500 hover:text-amber-400 transition-colors">Suggestion Box</a>
          <span class="mx-2">·</span>
          <span class="text-slate-600">v1.2.0</span>
          <span class="mx-2">·</span>
          <span class="text-slate-600">Created and Maintained by Javier!</span>
        </p>
      </div>
    </footer>
  </body>
</html>

<style is:global>
  @import '../styles/global.css';
</style>
